<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Czy Windows może zastąpić Linuxa? - Krzysztof Śmigiel | Blog</title>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:700,600,400" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  <link href="http://ksmigiel.com//index.xml" rel="alternate" type="application/rss+xml" title="Krzysztof Śmigiel | Blog" />
  <meta name="title" content="http://ksmigiel.com/">
  <link rel="canonical" href="http://ksmigiel.com/">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/github.min.css">
  <script src="/js/highlight.js"></script>
  <meta property="og:title" content="Krzysztof Śmigiel | Blog"/>
  <meta property="og:url" content="http://ksmigiel.com/"/>
  <meta property="og:image" content="http://ksmigiel.com//images/"/>   
  <meta property="og:site_name" content="Krzysztof Śmigiel | Blog">
</head>
<body>
<section class="site-nav">
  <header>
    <nav id="navigation">
      <a href="/" class="home">Blog</a>
      <a href="/tags">Tagi</a>
      <a href="/post">Archiwum</a>
      <a href="/about">O mnie</a>
    </nav>
  </header>
</section>


  
  <article>
    <div class="container">
      <header>
        <div class="meta">
          Autor <address><a rel="author" href="http://ksmigiel.com" title="Krzysztof Śmigiel" target="_blank">Krzysztof Śmigiel</a></address> &mdash;
          <time pubdate datetime="2016-01-28" title="2016-01-28">28 January 2016</time>
          <ul id="tags">
            
            <li><a href="/tags/powershell">#powershell</a> </li>
            
            <li><a href="/tags/linux">#linux</a> </li>
            
          </ul>
        </div>
        <h1 class="title">Czy Windows może zastąpić Linuxa?</h1>
        <h2 class="subtitle">Parę słów o podobieństwach w PowerShellu napisane</h2>
      </header>

      <section>
        

<p>Lata temu przeżywałem okres fascynacji Linuxem. Pierwszą dystrybucją, którą zainstalowałem bodajże z 5 płyt CD był <strong>Mandrake Linux</strong> (kontynuowany jako <a href="https://pl.wikipedia.org/wiki/Mandriva_Linux">Mandriva</a> - obecnie nie jest już utrzymywana). Potem, o ile mnie pamięć nie myli, był Slackware i Slax (jego mniejszy kuzyn-portable).</p>

<h2 id="linuxy-i-konsola:8c67b377fe66f9eab5dd926e008c6d14">Linuxy i konsola</h2>

<p>Bardzo lubiłem dystrybucje <a href="https://pl.wikipedia.org/wiki/Live_CD"><strong>Live CD</strong></a>. Wszystko zaczęło się, gdy popsułem bootloadera z instalacją Windows XP i przez kilka dni w domu nikt nie mógł używać komputera (no poza mną - linuksiarzem). Mieliśmy wtedy tylko jeden komputer (jakiś AMD Duron 800 Mhz), więc rodzina szybko wywarła na mnie wpływ i posprzątałem po sobie formatując cały dysk twardy, razem ze swoją świętą instalacją Linuxa. Nie chcąc w przyszłości psuć domownikom partycji z systemem operacyjnym, zacząłem szukać &ldquo;bezpieczniejszych&rdquo; alternatyw.</p>

<p>Plusem systemów Live CD było to, że nie wymagały instalacji. Całość ładowana była do pamięci RAM, tak więc zaraz po włożeniu płytki mieliśmy w pełni działającego Linuxa. Problemem było zapisywanie swojej pracy i stanu systemu, jednak wspomniany Slax potrafił robić &ldquo;snapshoty&rdquo; i poprzez definicję modułów startowych, jakie miały zostać załadowane przy następnym rozruchu, mogliśmy bez problemu wznowić poprzednią sesję.</p>

<p>Ale wiecie co? Ciągłe wkładanie i wyciąganie tej płyty w cale nie było takie wygodne. Poszedłem więc o krok dalej w tworzeniu swojego idealnego środowiska i złamałem wszelkie zasady ładując dystrybucję Live CD z dysku twardego do pamięci. Dla domowników cała operacja była transparentna, bo na dyskietce miałem bootloadera <a href="http://lilo.alioth.debian.org/">lilo</a> ze Slax&rsquo;em. Zatem udało mi się zamienić płytę na dyskietkę. Tak. Szczerze, nie wiem co mną wtedy kierowało, ale jak tego dokonałem znajdziecie w poście, który napisałem <a href="http://sysios.blogspot.com/2006/02/linux-z-pyty.html"><strong>10 lat</strong> temu!</a> W rzeczywistości wtedy zaczęła się moja przygoda z pisaniem (i na szczęście szybko się skończyła :D).</p>

<h3 id="konsola:8c67b377fe66f9eab5dd926e008c6d14">Konsola!</h3>

<p>Wszystkiemu winna była konsola. Wklepywanie komand w terminalu sprawiało mi tyle przyjemności, że po pewnym czasie w ogóle przestałem używać GUI (KDE, Gnome) i myszy. Koajrzycie <a href="http://ekg.chmurka.net/">EKG</a> (<strong>E</strong>ksperymentalny <strong>K</strong>lient <strong>G</strong>adu-Gadu)? To był dopiero hardkor. Poza surfowaniem po necie wszystko robiłem z poziomu terminala:, IRC, bash, python, vim i to poczucie &ldquo;hakowania&rdquo; było uzależniające.</p>

<h3 id="zawodowy-windows:8c67b377fe66f9eab5dd926e008c6d14">Zawodowy Windows!</h3>

<p>Po okresie &ldquo;trybu tekstowego&rdquo; wróciłem do normalności i Windowsa, na którym był większy wybór narzędzi do obróbki audio i edycji nut (jak wiecie zajmuje się tym w tak zwanym &ldquo;międzyczasie&rdquo;). Na początku przełączałem się między systemami, w zależności od tego co w danej chwili było mi potrzebne. Z czasem jednak godziny spędzane na Windowsie zaczęły przeważać i swoje &ldquo;hakersko&rdquo;-programistyczne nawyki zacząłem też tam przenosić. Poznałem platformę .NET, C#, VB. Na studiach wszystkie projekty pisałem w C# i w tym kierunku poprowadziłem swoją karierę. Związałem się zawodowo z Windowsem i chcąć nie chcąc musiałem zacząć szukać narzędzi, które wypełniłyby lukę po terminalu z Linuxa.</p>

<h2 id="posh-zastępca-basha:8c67b377fe66f9eab5dd926e008c6d14">posh - zastępca basha</h2>

<p>posh (<strong>P</strong>ower<strong>Sh</strong>ell) okazał się kapitalnym zamiennikiem. Nie dość, że mogłem ponownie klepać sobie komendy z terminala (nawet nazywające się tak samo, ale o tym zaraz), to świetnie sprawdził się jako pomoc w automatycji zadań, a jego integracja z .NET dostarczała ogromne możliwości eksperymentowania z punktu widzenia programisty. Serio, jeśli jeszcze nie korzystałeś z PowerShella w inny sposób, niż jak z &ldquo;linii komend&rdquo; i zamiennika <code>cmd.exe</code>, koniecznie poświęc mu trochę czasu. Taka znajomość zaprocentuje. Mam nadzieję, że bardzo szybki przegląd ciekawostek posh&rsquo;a zachęci Cię do poznania tej &ldquo;linuxowej części windowsa&rdquo; :)</p>

<h3 id="cmdlet-i-alias:8c67b377fe66f9eab5dd926e008c6d14">cmdlet i alias</h3>

<p><strong>cmdlet</strong> jest jakby .NET&rsquo;owym obudowaniem zwykłego polecenia. Powrzechnie jest przyjęte nazywać je zgodnie ze schematem <em>Czasownik-Rzeczownik</em>, np. <code>Get-Location</code>. Wspominałem wyżej o takich samych nazwach komend, odpowiednikach Linuxowych: w rzeczywistości są to <strong>aliasy</strong> do innych cmdletów.</p>

<table>
<thead>
<tr>
<th>alias</th>
<th>cmdlet</th>
</tr>
</thead>

<tbody>
<tr>
<td>pwd</td>
<td>Get-Location</td>
</tr>

<tr>
<td>ls</td>
<td>Get-ChildItem</td>
</tr>

<tr>
<td>cd</td>
<td>Set-Location</td>
</tr>

<tr>
<td>ps</td>
<td>Get-Process</td>
</tr>

<tr>
<td>mv</td>
<td>Move-Item</td>
</tr>

<tr>
<td>cp</td>
<td>Copy-Item</td>
</tr>

<tr>
<td>man</td>
<td>help</td>
</tr>

<tr>
<td>rm</td>
<td>Remove-Item</td>
</tr>

<tr>
<td>cat</td>
<td>Get-Content</td>
</tr>

<tr>
<td>grep</td>
<td>Select-String</td>
</tr>

<tr>
<td>kill</td>
<td>Stop-Process</td>
</tr>

<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>

<p>Dla niezaznajomionych z terminologią basha jego odpowiedniki w posh&rsquo;u z pewnością okażą się bardziej intuicyjne i łatwiejsze w przyswojeniu.
Do identyfkowania aliasów i cmdletów służy <code>Get-Alias</code>:</p>

<pre><code class="language-powershell">PS&gt; Get-Alias cd

CommandType     Name
-----------     ----
Alias           cd -&gt; Set-Location

</code></pre>

<p>Oraz w przeciwnym kierunku, dostępne aliasy dla cmdleta:</p>

<pre><code class="language-powershell">PS&gt; Get-Alias -Definition Get-Location

CommandType     Name
-----------     ----
Alias           gl -&gt; Get-Location
Alias           pwd -&gt; Get-Location

</code></pre>

<p>Zwróćię uwagę na <code>-Definition</code>. Praktycznie każdy cmdlet akceptuje jeden lub więcej opcjonalnych parametrów, które po poleceniu poprzedzamy średnikiem (<em>-NazwaParametru Wartość</em>). <code>Get-Help</code> i MSDN będą niezastąpionymi źródłami wiedzy na ten temat. Możemy jednak szybko przeskanować interesujący nas cmdlet/obiekt.</p>

<h3 id="psobjet:8c67b377fe66f9eab5dd926e008c6d14">&lt;psobjet&gt;</h3>

<p>Wiedząc już, że polecenia są opakowane w obiekty, możemy zaglądnąc do &ldquo;bebchów&rdquo; każdego z nich.</p>

<pre><code class="language-powershell">PS&gt; Get-Alias | Get-Member

   TypeName: System.Management.Automation.AliasInfo

Name                MemberType     Definition
----                ----------     ----------
Equals              Method         bool Equals(System.Object obj)
GetHashCode         Method         int GetHashCode()
GetType             Method         type GetType()
ToString            Method         string ToString()
Definition          Property       string Definition {get;}
[...]
</code></pre>

<p>Jak widzicie mamy tutaj wgląd w strukturę całego obiektu, jego metody, właściwości. Przydaje się to szczególnie wtedy, gdy chcemy szybko rzucić okiem na dany cmdlet bez zagłębiania się w dokumentację, która z resztą jest całkiem opasła.</p>

<h3 id="operator-pipy:8c67b377fe66f9eab5dd926e008c6d14">Operator pipy</h3>

<p><strong>&rdquo;|&rdquo;</strong>, czyli tzw. <em>pipeline operator</em> pozwala na przekazywanie wyniku danego wywołania do kolejnego bez potrzeby rozdzielania go na osobne deklaracje etc. Bardzo popularna technika stosowana m.in w językach funkcyjnych (&ldquo;|&gt;&rdquo; z F#). Powyżej przekazaliśmy <code>&lt;psobjet&gt; Get-Alias</code> do <code>Get-Member</code>, który (jak zaglądniecie do środka) przyjmuje paramter <code>[-InputObject &lt;psobject&gt;]</code>. W ten sposób wiemy, że możemy korzystać z pipeline&rsquo;a. Zwróćie też uwagę na <code>TypeName: System.Management.Automation.AliasInfo</code> - jak widać nie kłamałem z tym .NET&rsquo;em w środku posha :)</p>

<h3 id="filtrowanie-i-formatowanie:8c67b377fe66f9eab5dd926e008c6d14">Filtrowanie i formatowanie</h3>

<p>W pudełku z PS&rsquo;em znajdziemy zestaw narzędzi umożliwiających w przystępny sposób formatowanie wyniku końcowego naszego polecenia/skryptu. Powiedzmy, że chcę listę pierwszych 10-ciu procesów i wynik ten dostać w postaci JSON. Brzmi skomplikowanie? Jak najbardziej! Tylko szkoda, że rozwiązanie jest trywialne:</p>

<pre><code class="language-powershell">PS&gt; ps | select Name, Id -First 10 | ConvertTo-Json

[
    {
        &quot;Name&quot;:  &quot;ApplicationFrameHost&quot;,
        &quot;Id&quot;:  4244
    },
    {
        &quot;Name&quot;:  &quot;AudioDevMon&quot;,
        &quot;Id&quot;:  2124
    },
[...]
</code></pre>

<p>Albo tylko procesy Chrome?</p>

<pre><code class="language-powershell">PS&gt; ps | where ProcessName -eq chrome

Handles  NPM(K)    PM(K)      WS(K) VM(M)   CPU(s)     Id  SI ProcessName
-------  ------    -----      ----- -----   ------     --  -- -----------
    287      26    55452      83712   315     3,16   2804   1 chrome
   1661      56   109428     144816   461   438,73   4232   1 chrome
[...]
</code></pre>

<p>Z przyzwyczajenia używam możliwie najnowszej składni (PowerShell 5.0). W starszych wersjach wyglądałoby to nieco inaczej:</p>

<pre><code class="language-powershell">Get-Process | Where-Object { $_.ProcessName -eq &quot;chrome&quot; }
</code></pre>

<p>Jako ciekawostę polecam sprawdzić co robi <code>Out-GridView</code>.</p>

<h3 id="użycie-net:8c67b377fe66f9eab5dd926e008c6d14">Użycie .NET</h3>

<p>Do metod <code>&lt;psobject&gt;</code> możemy dobrać się na dwa sposoby:</p>

<pre><code class="language-powershell"># Bezpośrednio
(Get-Alias).GetType()

# Poprzez przypisanie
$alias = Get-Alias
$alias.GetType()
</code></pre>

<p>Tworzenie obiektów .NET też trudne nie jest:</p>

<pre><code class="language-powershell">$random = New-Object -TypeName System.Random
$random.Next()
# 1168874665 - serio przepisałem to z terminala i zapewniam losowość :D
</code></pre>

<h3 id="przydatne-skróty:8c67b377fe66f9eab5dd926e008c6d14">Przydatne skróty</h3>

<p>Na koniec jeszcze o paru wspomagaczach umilających pracę z poshem:</p>

<ol>
<li><code>ctrl + space</code> przy operowaniu z obiektami .NET działa jako autocompleter.</li>
<li><code>tab</code> podpowiada parametry i property cmdletów.</li>
<li><code>f7 lub ↑/↓</code> historia poleceń (niestety ładny bufor z f7 został usunięty w win10).</li>
<li><a href="http://www.computerperformance.co.uk/powershell/powershell3_ise.htm">PowerShell ISE</a> - mały edytor z kolorowaniem składni i wbudowaną dokumentacją. Dostarczany w zestawie z poshem.</li>
<li><code>pushd/popd</code> jako zamiennik <code>cd</code>. Pozwala wrócić do poprzedniej lokacji. Można sobie oaliasować np. <code>cd/dc</code>.</li>
</ol>

<h2 id="windows-zlinuksiał:8c67b377fe66f9eab5dd926e008c6d14">Windows &ldquo;zlinuksiał&rdquo;?</h2>

<p>To pytanie zadane jest raczej w celu humorystycznym, choć Windowsowi w ostatnim czasie przybyło wiele cech, które mogłbyby pomóc w znalezieniu na nie odpowiedzi. Menedżery pakietów <a href="https://chocolatey.org/">Chocolatey</a> i <a href="http://www.hanselman.com/blog/AptGetForWindowsOneGetAndChocolateyOnWindows10.aspx">OneGet</a> (dostarczany w Win10) będące odpowiednikiem <code>apt-get</code> i wiele repozytoriów open-source do złudzenia przypominają ekosystem Linuxa. Dla mnie bomba! Bo czuję się jak ryba w wodzie.</p>

<hr />

<ol>
<li><a href="https://pl.wikipedia.org/wiki/Mandriva_Linux">https://pl.wikipedia.org/wiki/Mandriva_Linux</a></li>
<li><a href="https://pl.wikipedia.org/wiki/Live_CD">https://pl.wikipedia.org/wiki/Live_CD</a></li>
<li><a href="http://sysios.blogspot.com/2006/02/linux-z-pyty.html">http://sysios.blogspot.com/2006/02/linux-z-pyty.html</a></li>
<li><a href="http://lilo.alioth.debian.org/">http://lilo.alioth.debian.org/</a></li>
<li><a href="http://ekg.chmurka.net/">http://ekg.chmurka.net/</a></li>
<li><a href="http://www.computerperformance.co.uk/powershell/powershell3_ise.htm">http://www.computerperformance.co.uk/powershell/powershell3_ise.htm</a></li>
<li><a href="https://chocolatey.org/">https://chocolatey.org/</a></li>
<li><a href="http://www.hanselman.com/blog/AptGetForWindowsOneGetAndChocolateyOnWindows10.aspx">http://www.hanselman.com/blog/AptGetForWindowsOneGetAndChocolateyOnWindows10.aspx</a></li>
</ol>

        <div class="social">
  <div>
    <a class="twitter-share-button"
      href="https://twitter.com/share"
      data-via="k_smigiel"
      data-url="http://ksmigiel.com/2016/01/powershell">
      Tweet
    </a> 
  </div>
  <div>
    <div class="fb-like" data-width="450" data-layout="button_count" data-action="like" data-show-faces="false" data-send="false"></div>
  </div>
</div>


      </section>

      
      <section>
        <div id="disqus_thread"></div>
<script type="text/javascript">
   
  var disqus_shortname = 'ksmigiel'; 

   
  (function() {
     var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
     dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
     (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
   })();
</script>

      </section>
      

    </div>
  </article>
<footer class="site-footer">
  <div class="container">
    <nav>
      <a href="/">Blog</a> &middot;
      <a href="/tags">Tagi</a> &middot;
      <a href="/post">Archiwum</a> &middot;
      <a href="/about">O mnie</a>
    </nav>

    <nav class="social">
      
      <a href="https://twitter.com/k_smigiel" title="Follow on Twitter" target="_blank"><i class="icon icon-twitter black"></i></a>
      
      
      <a href="https://github.com/ksmigiel" title="Follow on Github" target="_blank"><i class="icon icon-github black"></i></a>
      
          
      <a href="/index.xml" title="RSS Feed">
        <i class="icon icon-rss black"></i>
      </a>
    </nav>
  </div>
</footer>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js"></script>


<script>window.twttr=(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);t._e=[];t.ready=function(f){t._e.push(f);};return t;}(document,"script","twitter-wjs"));</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
var js, fjs = d.getElementsByTagName(s)[0];
if (d.getElementById(id)) return;
js = d.createElement(s); js.id = id;
js.src = "//connect.facebook.net/pl_PL/sdk.js#xfbml=1&version=v2.2&appId=901391149893781";
fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58701947-1', 'auto');
  ga('send', 'pageview');

</script>






</body>
</html>

